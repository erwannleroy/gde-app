<div class="row row-flex" style="margin-top:1vw;">

  <div style="background-color: #084887;width:2px;"></div>
  <div class="col">
    <h4>Génération Excel</h4>

    <div class="container">
      <div class="row row-flex">
        <div class="col-sm onglet align-self-center"
          [class.waiting]="bvDecSent && !result.objRetComputeOk && !result.error">
          <div class="container">
            <div class="row align-self-center">
              <div class="col-10">Objectifs de rétention</div>
            </div>
            <div class="row align-self-center">
              <span class="badge bg-secondary" *ngIf="!bvDecSent">Pas de données</span>
              <span class="badge bg-primary"
                *ngIf="bvDecSent && !result.objRetComputeOk && !result.error">Calcul
                {{result.objRetComputeProgress}}%</span>
              <span class="badge bg-success" *ngIf="result && result.objRetComputeOk">Généré</span>
              <span class="badge bg-danger" *ngIf="bvDecSent && result.error">Erreur</span>
            </div>
          </div>
        </div>
        <div class="col-sm onglet align-self-center"
          [class.waiting]="decSent && !result.retComputeOk">
          <div class="container">
            <div class="row align-self-center">
              <div class="col-10">Rétention des bassins</div>
            </div>
            <div class="row align-self-center">
              <span class="badge bg-secondary" *ngIf="!decSent">Pas de données</span>
              <span class="badge bg-primary waiting"
                *ngIf="decSent && !result.retComputeOk">Calcul
                {{result.retComputeProgress}}%</span>
              <span class="badge bg-success" *ngIf="result && result.retComputeOk">Généré</span>
              <span class="badge bg-danger" *ngIf="decSent && result.error">Erreur</span>
            </div>
          </div>
        </div>
        <div class="col-sm onglet align-self-center content"
          [class.waiting]="bvExuSent && !(result.q100ComputeOk|| result.cassisComputeOk)">
          <div class="container">
            <div class="row align-self-center">
              <div class="col-10">Q100 et déversoirs</div>
            </div>
            <div class="row align-self-center">
              <span class="badge bg-secondary" *ngIf="!bvExuSent">Pas de données</span>
              <span class="badge bg-primary waiting"
                *ngIf="bvExuSent && !(result.q100ComputeOk || result.cassisComputeOk)">Calcul
                Q100({{result.q100InProgress}}%)
                - Cassis({{result.cassisInProgress}}%)</span>
              <span class="badge bg-success" *ngIf="result && result.q100ComputeOk && result.cassisComputeOk">Généré</span>
              <span class="badge bg-danger" *ngIf="bvExuSent && result.error">Erreur</span>
            </div>
          </div>
        </div>
        <div *ngIf="!result || !result.dbfComputationOk" class="col-1 onglet onglet-icon">
          <img style="height:auto;width:80px" src="../../assets/download-dbf-ko.png" />
        </div>
        <div *ngIf="result && result.dbfComputationOk" class="col-1 onglet onglet-icon"
             (click)="downloadDbfFile()">
              <img style="height:auto;width:80px;cursor: pointer;" src="../../assets/download-dbf.png" />
          </div>
        <div *ngIf="!result || !result.xlsComputationOk" class="col-1 onglet onglet-icon">
          <img style="height:auto;width:80px" src="../../assets/download-xls-ko.png" />
        </div>
        <div *ngIf="result && result.xlsComputationOk" class="col-1 onglet onglet-icon"
             (click)="downloadXlsFile()">
          <img style="height:auto;width:80px;cursor: pointer;" src="../../assets/download-xls.png" />
        </div>
      </div>
    </div>
  </div>
</div>
